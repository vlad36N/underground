String AMEngineVersion = "";
            String AMProductVersion = "";
            String AntispywareSignatureVersion = "";
            String AntivirusSignatureVersion = "";
            String AntispywareSignatureLastUpdated = "";
            String AntispywareSignatureLastUpdated_st = "";

//check defender AV Security start
                try
                {
                    ManagementObjectSearcher searcher = new ManagementObjectSearcher("root\\microsoft\\Windows\\Defender", "SELECT * FROM MSFT_MpComputerStatus");
                    foreach (ManagementObject m_PF in searcher.Get())
                    {
                        AMEngineVersion = m_PF["AMEngineVersion"].ToString();
                        AMProductVersion = m_PF["AMProductVersion"].ToString();
                        AntispywareSignatureVersion = m_PF["AntispywareSignatureVersion"].ToString();
                        AntivirusSignatureVersion = m_PF["AntivirusSignatureVersion"].ToString();
                        AntispywareSignatureLastUpdated = m_PF["AntispywareSignatureLastUpdated"].ToString();
                        AntispywareSignatureLastUpdated = AntispywareSignatureLastUpdated.Replace(".000000+000", "");
                        string format = "yyyyMMddHHmmss";
                        DateTime dt = DateTime.ParseExact(AntispywareSignatureLastUpdated, format, null);
                        AntispywareSignatureLastUpdated_st = dt.ToString();
                    }
                    searcher.Dispose();
                }
                catch (Exception se)
                {
                    using (StreamWriter outputFile = new StreamWriter(@"" + bits_path_64 + "", true))
                    {
                        outputFile.WriteLine("Error checking defender AV Security : " + se.Message + "");
                    }
                }
                //check defender AV Security end
